rules:
  - id: filesystem-access
    patterns:
      - pattern-either:
        - pattern: open(...)
        - pattern: shutil.$FUNC(...)
        - pattern: tempfile.$FUNC(...)
        - pattern: os.$FUNC(...)
        - pattern: pathlib.$FUNC(...)
      - pattern-not: import os.path
      - pattern-not-inside: |
          if __name__ == '__main__':
            ...
      - pattern-not-inside: |
          def main(...):
            ...
    message: |
        Detected APIs used to access the filesystem other than the logging and state serialization APIs provided by BaseConnector.
    languages: [python]
    severity: ERROR
